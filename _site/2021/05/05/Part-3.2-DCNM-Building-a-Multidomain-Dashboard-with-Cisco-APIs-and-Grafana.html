<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Part 3.2 [dcnm] : building a multidomain dashboard with cisco apis and grafana | Jamie Sullivan’s Blog</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Part 3.2 [dcnm] : building a multidomain dashboard with cisco apis and grafana" />
<meta name="author" content="Jamie Sullivan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Part (3.2) DCNM and VXLAN BGP and EVPN Lab with Nexus 9000v" />
<meta property="og:description" content="Part (3.2) DCNM and VXLAN BGP and EVPN Lab with Nexus 9000v" />
<link rel="canonical" href="https://j-sulliman.github.io//2021/05/05/Part-3.2-DCNM-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html" />
<meta property="og:url" content="https://j-sulliman.github.io//2021/05/05/Part-3.2-DCNM-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html" />
<meta property="og:site_name" content="Jamie Sullivan’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-05T08:00:34+12:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Part 3.2 [dcnm] : building a multidomain dashboard with cisco apis and grafana" />
<script type="application/ld+json">
{"headline":"Part 3.2 [dcnm] : building a multidomain dashboard with cisco apis and grafana","dateModified":"2021-05-05T08:00:34+12:00","datePublished":"2021-05-05T08:00:34+12:00","url":"https://j-sulliman.github.io//2021/05/05/Part-3.2-DCNM-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html","author":{"@type":"Person","name":"Jamie Sullivan"},"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://j-sulliman.github.io//2021/05/05/Part-3.2-DCNM-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html"},"description":"Part (3.2) DCNM and VXLAN BGP and EVPN Lab with Nexus 9000v","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://j-sulliman.github.io//feed.xml" title="Jamie Sullivan&apos;s Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Jamie Sullivan&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/test.html">Home</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Part 3.2 [dcnm] : building a multidomain dashboard with cisco apis and grafana</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-05-05T08:00:34+12:00" itemprop="datePublished">May 5, 2021
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Jamie Sullivan</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="part-32-dcnm-and-vxlan-bgp-and-evpn-lab-with-nexus-9000v">Part (3.2) DCNM and VXLAN BGP and EVPN Lab with Nexus 9000v</h1>

<h2 id="321-overview">3.2.1 Overview</h2>
<p>If you’ve completed section <a href="https://j-sulliman.github.io/2021/05/04/Part-3.1-DCNM-Lab-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html">3.1 DCNM VXLAN BGP and EVPN Lab</a>, you’ll now have a DCNM and N9000v EVPN and VXLAN Virtual Sandbox to test our APIs and visualisations with Python, Django and Grafana.</p>

<p>We stepped through an overview of a Grafana Dashboard last week, this week, we’ll be focussing on DCNM as shown in green:
<img src="https://github.com/j-sulliman/j-sulliman.github.io/blob/master/images/Grafana_overview_DCNM.png?raw=true" alt="Solution Overview" /></p>

<p>Links to other articles in this series are outlined below.</p>

<table>
  <thead>
    <tr>
      <th>Section</th>
      <th>Architecture</th>
      <th>Link</th>
      <th>Topic</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1.0</td>
      <td>Introduction</td>
      <td><a href="https://j-sulliman.github.io/2021/04/26/Part-1-Intro-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html">building a multidomain dashboard with cisco apis and grafana</a></td>
      <td>Solution Overview</td>
    </tr>
    <tr>
      <td>2.0</td>
      <td>Meraki</td>
      <td><a href="https://j-sulliman.github.io/2021/04/26/Part-2-Meraki-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html">Building a Meraki Dashboard with Grafana, Django and Python</a></td>
      <td>Visualising Meraki APIs with Grafana.</td>
    </tr>
    <tr>
      <td>3.1</td>
      <td>DCNM &amp; EVPN VXLAN</td>
      <td><a href="https://j-sulliman.github.io/2021/05/04/Part-3.1-DCNM-Lab-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html">DCNM VXLAN BGP and EVPN Lab with Nexus 9000v</a></td>
      <td>DCNM, N9000v, EVPN and VXLAN Lab deployment</td>
    </tr>
    <tr>
      <td>3.2</td>
      <td>DCNM &amp; EVPN VXLAN</td>
      <td><a href="https://j-sulliman.github.io/2021/05/04/Part-3.2-DCNM-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html">Building a DCNM Dashboard with Grafana, Django and Python</a></td>
      <td>Visualising DCNM APIs with Grafana.</td>
    </tr>
    <tr>
      <td>4.1</td>
      <td>SDWAN</td>
      <td><a href="https://j-sulliman.github.io/2021/05/13/Part-4.1-SDWAN-Cisco-SDWAN-Lab-Build.html">Cisco SDWAN Virtual Lab Build</a></td>
      <td>Cisco SDWAN Virtual Lab deployment</td>
    </tr>
    <tr>
      <td>4.2</td>
      <td>SDWAN</td>
      <td><a href="https://j-sulliman.github.io/2021/05/17/Part-4.2-SDWAN-Cisco-SDWAN-vManage-API-Visualisations-with-Grafana.html">Building a SD-WAN Dashboard with Grafana, Django and Python</a></td>
      <td>Visualising vManage APIs with Grafana</td>
    </tr>
    <tr>
      <td>5.0</td>
      <td>OpenVuln API</td>
      <td><a href="https://j-sulliman.github.io/2021/05/23/Part-5.0-OpenVuln-API-Cisco-PSIRT-and-Security-Vulnerability-Dashboard-with-Grafana.html">Building a Security Advisory Dashboard with Grafana, Django and Python</a></td>
      <td>Visualising OpenVuln APIs with Grafana</td>
    </tr>
    <tr>
      <td>6.0</td>
      <td>DNA Center</td>
      <td><a href="https://j-sulliman.github.io/2021/05/25/Part-6.0-DNAC-Cisco-DNA-Center-Dashboard-with-Grafana.html">Building a DNA-C Dashboard with Grafana, Django and Python</a></td>
      <td>Visualising DNA-C APIs with Grafana</td>
    </tr>
    <tr>
      <td>7.0</td>
      <td>ACI and Conclusion</td>
      <td><a href="https://j-sulliman.github.io/2021/06/02/Part-7.0-ACI-and-Conclusion-Building-a-Multidomain-Dashboard-with-ACI-APIs-and-Grafana.html">Building an ACI Dashboard with Grafana, Django and Python</a></td>
      <td>Visualising ACI APIs with Grafana, Django send_email and django_tables2</td>
    </tr>
  </tbody>
</table>

<p>By the end of this article we’ll have:</p>
<ul>
  <li>Gained familiarity with DCNM APIs and python requests</li>
  <li>Experimented with API endpoints outlined in the API reference and the output of queries</li>
  <li>Defined our Django Model classes and written output to our PostgresSQL database</li>
  <li>Experimented with visualisations of the database with grafana</li>
</ul>

<h2 id="322-resources">3.2.2 Resources</h2>
<ul>
  <li><a href="https://developer.cisco.com/docs/data-center-network-manager/11-5-1/">DCNM REST API Reference Guide</a></li>
  <li><a href="https://www.cisco.com/c/en/us/td/docs/dcn/dcnm/1151/configuration/lanfabric/cisco-dcnm-lanfabric-configuration-guide-1151/managing-greenfield-vxlan-fabric.html">Easy Provisioning of VXLAN BGP EVPN Fabrics</a></li>
  <li><a href="https://www.cisco.com/c/en/us/td/docs/dcn/dcnm/1151/configuration/lanfabric/cisco-dcnm-lanfabric-configuration-guide-1151/border-provisioning-multisite.html">Auto-Provisioning Border Gateways with Multi-Site Domains</a></li>
  <li><a href="https://www.cisco.com/c/en/us/products/collateral/switches/nexus-9000-series-switches/white-paper-c11-739942.html">VXLAN EVPN Multi-Site Design and Deployment Whitepaper</a></li>
  <li><a href="https://www.cisco.com/c/en/us/td/docs/dcn/dcnm/1151/configuration/lanfabric/cisco-dcnm-lanfabric-configuration-guide-1151/border-provisioning-multisite.html">Cisco Communities - Data Center</a></li>
</ul>

<h2 id="323-django-setup">3.2.3 Django Setup</h2>

<h3 id="3231-create-the-dcnm-app-directory-structure-in-django">3.2.3.1 Create the DCNM App (Directory Structure) in django</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">startapp</span> <span class="n">dcnm</span>
<span class="err">$</span> <span class="n">ls</span> <span class="n">dcnm</span><span class="o">/</span>
<span class="n">admin</span><span class="p">.</span><span class="n">py</span>  <span class="n">apps</span><span class="p">.</span><span class="n">py</span>  <span class="n">__init__</span><span class="p">.</span><span class="n">py</span>  <span class="n">migrations</span>  <span class="n">models</span><span class="p">.</span><span class="n">py</span>  <span class="n">tests</span><span class="p">.</span><span class="n">py</span>  <span class="n">views</span><span class="p">.</span><span class="n">py</span>
</code></pre></div></div>

<p>Add the grafana app to cisco-grafana/settings.py:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Application definition
</span>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'django.contrib.admin'</span><span class="p">,</span>
    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="s">'meraki'</span><span class="p">,</span>
    <span class="s">'dcnm'</span><span class="p">,</span> <span class="c1"># Add this
</span><span class="p">]</span>
</code></pre></div></div>
<h2 id="324-python-dcnm-requests-functions">3.2.4 Python DCNM Requests functions</h2>

<h3 id="3241-dcnm-api-requests-functions">3.2.4.1 DCNM API Requests functions</h3>
<p>The <em>dcnm_http_get()</em> function in turn calls <em>get_auth_token()</em> which:</p>
<ul>
  <li>Sends an HTTP Post Request to <em>https://[dcnm-mgmt]/rest/logon</em> with a user name and password</li>
  <li>Takes the token from the <em>Dcnm-Token</em> key in the JSON response</li>
  <li>Uses this token to authenticate API calls to other API endpoints, <em>https://[DCNM-MGMT]/rest/inventory/switches</em>, in our example</li>
  <li>“Pretty Prints” the output <em>pp.pprint(device_list)</em> for validation</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DCNM_USER</span> <span class="o">=</span> <span class="s">"admin"</span>
<span class="n">DCNM_PASSWORD</span> <span class="o">=</span> <span class="s">"Cisco123!"</span>
<span class="n">dcnm</span> <span class="o">=</span> <span class="s">'192.168.200.230'</span>

<span class="k">def</span> <span class="nf">get_auth_token</span><span class="p">():</span>
    <span class="s">"""
    Building out Auth request. Using requests.post to make a call to the Auth Endpoint
    """</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">'https://{}/rest/logon'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">dcnm</span><span class="p">)</span>       <span class="c1"># Endpoint URL
</span>    <span class="n">data</span><span class="o">=</span> <span class="s">'{"expirationTime": 360000}'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="n">DCNM_USER</span><span class="p">,</span> <span class="n">DCNM_PASSWORD</span><span class="p">),</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Make the POST Request
</span>    <span class="n">token</span> <span class="o">=</span> <span class="n">resp</span><span class="p">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'Dcnm-Token'</span><span class="p">]</span>    <span class="c1"># Retrieve the Token from the returned JSON
</span>    <span class="k">print</span><span class="p">(</span><span class="s">"Token Retrieved: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">token</span><span class="p">))</span>  <span class="c1"># Print out the Token
</span>    <span class="k">return</span> <span class="n">token</span>    <span class="c1"># Create a return statement to send the token back for later use
</span>

<span class="k">def</span> <span class="nf">dcnm_http_get</span><span class="p">(</span><span class="n">dcnm_class</span><span class="p">):</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">get_auth_token</span><span class="p">()</span> <span class="c1"># Get a Token
</span>    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">=</span> <span class="s">'https://{}/rest{}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">dcnm</span><span class="p">,</span> <span class="n">dcnm_class</span><span class="p">)</span>  <span class="c1">#Network Device endpoint
</span>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">hdr</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Dcnm-Token'</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span> <span class="s">'content-type'</span> <span class="p">:</span> <span class="s">'application/json'</span><span class="p">}</span>
    <span class="n">querystring</span> <span class="o">=</span> <span class="s">''</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">hdr</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>  <span class="c1"># Make the Get Request
</span>    <span class="n">device_list</span> <span class="o">=</span> <span class="n">resp</span><span class="p">.</span><span class="n">json</span><span class="p">()</span> <span class="c1"># Capture data from the controller
</span>    <span class="n">pp</span><span class="p">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">device_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">device_list</span> <span class="c1"># Pretty print the data
</span>
</code></pre></div></div>

<p>Run the functions and validate the output - we’ll start with the <em>/inventory/switches</em> endpoint in our example.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dcnm_http_get</span><span class="p">(</span><span class="s">'/inventory/switches'</span><span class="p">)</span>

<span class="p">[{</span><span class="s">'activeSupSlot'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'availPorts'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'colDBId'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'connUnitStatus'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'consistencyState'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'contact'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
  <span class="s">'cpuUsage'</span><span class="p">:</span> <span class="mi">39</span><span class="p">,</span>
  <span class="s">'displayHdrs'</span><span class="p">:</span> <span class="p">[</span><span class="s">'Name'</span><span class="p">,</span>
                  <span class="s">'IP Address'</span><span class="p">,</span>
                  <span class="s">'Fabric'</span><span class="p">,</span>
                  <span class="s">'WWN'</span><span class="p">,</span>
                  <span class="s">'FC Ports'</span><span class="p">,</span>
                  <span class="s">'Vendor'</span><span class="p">,</span>
                  <span class="s">'Model'</span><span class="p">,</span>
                  <span class="s">'Release'</span><span class="p">,</span>
                  <span class="s">'UpTime'</span><span class="p">],</span>
  <span class="s">'displayValues'</span><span class="p">:</span> <span class="p">[</span><span class="s">'dc1-bdlf-001'</span><span class="p">,</span>
                    <span class="s">'192.168.200.228'</span><span class="p">,</span>
                    <span class="s">'akl-fabric-01'</span><span class="p">,</span>
                    <span class="s">'9ENNZ72SXGG'</span><span class="p">,</span>
                    <span class="s">'64'</span><span class="p">,</span>
                    <span class="s">'Cisco'</span><span class="p">,</span>
                    <span class="s">'N9K-C9300v'</span><span class="p">,</span>
                    <span class="s">'9.3(7)'</span><span class="p">,</span>
                    <span class="s">'1 day, 11:12:03'</span><span class="p">],</span>
  <span class="s">'domain'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'domainID'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'fabricName'</span><span class="p">:</span> <span class="s">'akl-fabric-01'</span><span class="p">,</span>
  <span class="s">'fcoeEnabled'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'fex'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'fexMap'</span><span class="p">:</span> <span class="p">{},</span>
  <span class="s">'fid'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="s">'health'</span><span class="p">:</span> <span class="mi">54</span><span class="p">,</span>
  <span class="s">'hostName'</span><span class="p">:</span> <span class="s">'dc1-bdlf-001'</span><span class="p">,</span>
  <span class="s">'index'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s">'ipAddress'</span><span class="p">:</span> <span class="s">'192.168.200.228'</span><span class="p">,</span>
  <span class="s">'ipDomain'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
  <span class="s">'isLan'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'isNonNexus'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'isPmCollect'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'isVpcConfigured'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'is_smlic_enabled'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'keepAliveState'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'lastScanTime'</span><span class="p">:</span> <span class="mi">1620247841164</span><span class="p">,</span>
  <span class="s">'licenseDetail'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'licenseViolation'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'linkName'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'location'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
  <span class="s">'logicalName'</span><span class="p">:</span> <span class="s">'dc1-bdlf-001'</span><span class="p">,</span>
  <span class="s">'managable'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
  <span class="s">'mds'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'membership'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'memoryUsage'</span><span class="p">:</span> <span class="mi">51</span><span class="p">,</span>
  <span class="s">'mgmtAddress'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'mode'</span><span class="p">:</span> <span class="s">'Normal'</span><span class="p">,</span>
  <span class="s">'model'</span><span class="p">:</span> <span class="s">'N9K-C9300v'</span><span class="p">,</span>
  <span class="s">'modelType'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'modules'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'name'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'network'</span><span class="p">:</span> <span class="s">'LAN'</span><span class="p">,</span>
  <span class="s">'nonMdsModel'</span><span class="p">:</span> <span class="s">'N9K-C9300v'</span><span class="p">,</span>
  <span class="s">'npvEnabled'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'numberOfPorts'</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
  <span class="s">'peer'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'peerSerialNumber'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'peerSwitchDbId'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'peerlinkState'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'ports'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'present'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
  <span class="s">'primaryIP'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'primarySwitchDbID'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'principal'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'recvIntf'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'release'</span><span class="p">:</span> <span class="s">'9.3(7)'</span><span class="p">,</span>
  <span class="s">'role'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'sanAnalyticsCapable'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
  <span class="s">'scope'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'secondaryIP'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
  <span class="s">'secondarySwitchDbID'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'sendIntf'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'serialNumber'</span><span class="p">:</span> <span class="s">'9ENNZ72SXGG'</span><span class="p">,</span>
  <span class="s">'standbySupState'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'status'</span><span class="p">:</span> <span class="s">'ok'</span><span class="p">,</span>
  <span class="s">'swWwn'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'swWwnName'</span><span class="p">:</span> <span class="s">'9ENNZ72SXGG'</span><span class="p">,</span>
  <span class="s">'switchDbID'</span><span class="p">:</span> <span class="mi">127070</span><span class="p">,</span>
  <span class="s">'switchRole'</span><span class="p">:</span> <span class="s">'border gateway'</span><span class="p">,</span>
  <span class="s">'uid'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'unmanagableCause'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
  <span class="s">'upTime'</span><span class="p">:</span> <span class="mi">12672314</span><span class="p">,</span>
  <span class="s">'upTimeNumber'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'upTimeStr'</span><span class="p">:</span> <span class="s">'1 day, 11:12:03'</span><span class="p">,</span>
  <span class="s">'usedPorts'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'username'</span><span class="p">:</span> <span class="s">'V+g7SgiCGkvf3Q8BS91XoLZZxPWGVQkBGkWei8oIwy1e'</span><span class="p">,</span>
  <span class="s">'vdcId'</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
  <span class="s">'vdcMac'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'vdcName'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
  <span class="s">'vendor'</span><span class="p">:</span> <span class="s">'Cisco'</span><span class="p">,</span>
  <span class="s">'version'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'vpcDomain'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">'vsanWwn'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'vsanWwnName'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
  <span class="s">'wwn'</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
</code></pre></div></div>

<p>Re-run the function this time using the endpoint / dn -  <em>/control/fabrics</em> and validate the output</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dcnm_http_get</span><span class="p">(</span><span class="s">'/control/fabrics'</span><span class="p">)</span>
</code></pre></div></div>
<p>You should receive output as below</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span><span class="s">'asn'</span><span class="p">:</span> <span class="s">'65001'</span><span class="p">,</span>
  <span class="s">'createdOn'</span><span class="p">:</span> <span class="mi">1619997808399</span><span class="p">,</span>
  <span class="s">'deviceType'</span><span class="p">:</span> <span class="s">'n9k'</span><span class="p">,</span>
  <span class="s">'fabricId'</span><span class="p">:</span> <span class="s">'FABRIC-3'</span><span class="p">,</span>
  <span class="s">'fabricName'</span><span class="p">:</span> <span class="s">'akl-fabric-01'</span><span class="p">,</span>
  <span class="s">'fabricTechnology'</span><span class="p">:</span> <span class="s">'VXLANFabric'</span><span class="p">,</span>
  <span class="s">'fabricTechnologyFriendly'</span><span class="p">:</span> <span class="s">'VXLAN Fabric'</span><span class="p">,</span>
  <span class="s">'fabricType'</span><span class="p">:</span> <span class="s">'Switch_Fabric'</span><span class="p">,</span>
  <span class="s">'fabricTypeFriendly'</span><span class="p">:</span> <span class="s">'Switch Fabric'</span><span class="p">,</span>
  <span class="s">'id'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="s">'modifiedOn'</span><span class="p">:</span> <span class="mi">1620125447004</span><span class="p">,</span>
  <span class="s">'networkExtensionTemplate'</span><span class="p">:</span> <span class="s">'Default_Network_Extension_Universal'</span><span class="p">,</span>
  <span class="s">'networkTemplate'</span><span class="p">:</span> <span class="s">'Default_Network_Universal'</span><span class="p">,</span>
  <span class="s">'nvPairs'</span><span class="p">:</span> <span class="p">{</span><span class="s">'AAA_REMOTE_IP_ENABLED'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'AAA_SERVER_CONF'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'ACTIVE_MIGRATION'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ADVERTISE_PIP_BGP'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'AGENT_INTF'</span><span class="p">:</span> <span class="s">'eth0'</span><span class="p">,</span>
              <span class="s">'ANYCAST_GW_MAC'</span><span class="p">:</span> <span class="s">'2020.0000.00aa'</span><span class="p">,</span>
              <span class="s">'ANYCAST_LB_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'ANYCAST_RP_IP_RANGE'</span><span class="p">:</span> <span class="s">'10.254.254.0/24'</span><span class="p">,</span>
              <span class="s">'ANYCAST_RP_IP_RANGE_INTERNAL'</span><span class="p">:</span> <span class="s">'10.254.254.0/24'</span><span class="p">,</span>
              <span class="s">'AUTO_SYMMETRIC_VRF_LITE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'BFD_AUTH_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'BFD_AUTH_KEY'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'BFD_AUTH_KEY_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'BFD_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'BFD_IBGP_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'BFD_ISIS_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'BFD_OSPF_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'BFD_PIM_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'BGP_AS'</span><span class="p">:</span> <span class="s">'65001'</span><span class="p">,</span>
              <span class="s">'BGP_AUTH_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'BGP_AUTH_KEY'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'BGP_AUTH_KEY_TYPE'</span><span class="p">:</span> <span class="s">'3'</span><span class="p">,</span>
              <span class="s">'BGP_LB_ID'</span><span class="p">:</span> <span class="s">'0'</span><span class="p">,</span>
              <span class="s">'BOOTSTRAP_CONF'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'BOOTSTRAP_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'BOOTSTRAP_MULTISUBNET'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'BOOTSTRAP_MULTISUBNET_INTERNAL'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'BRFIELD_DEBUG_FLAG'</span><span class="p">:</span> <span class="s">'Disable'</span><span class="p">,</span>
              <span class="s">'BROWNFIELD_NETWORK_NAME_FORMAT'</span><span class="p">:</span> <span class="s">'Auto_Net_VNI$$VNI$$_VLAN$$VLAN_ID$$'</span><span class="p">,</span>
              <span class="s">'CDP_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'COPP_POLICY'</span><span class="p">:</span> <span class="s">'strict'</span><span class="p">,</span>
              <span class="s">'DCI_SUBNET_RANGE'</span><span class="p">:</span> <span class="s">'10.33.0.0/16'</span><span class="p">,</span>
              <span class="s">'DCI_SUBNET_TARGET_MASK'</span><span class="p">:</span> <span class="s">'30'</span><span class="p">,</span>
              <span class="s">'DEAFULT_QUEUING_POLICY_CLOUDSCALE'</span><span class="p">:</span> <span class="s">'queuing_policy_default_8q_cloudscale'</span><span class="p">,</span>
              <span class="s">'DEAFULT_QUEUING_POLICY_OTHER'</span><span class="p">:</span> <span class="s">'queuing_policy_default_other'</span><span class="p">,</span>
              <span class="s">'DEAFULT_QUEUING_POLICY_R_SERIES'</span><span class="p">:</span> <span class="s">'queuing_policy_default_r_series'</span><span class="p">,</span>
              <span class="s">'DEPLOYMENT_FREEZE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'DHCP_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'DHCP_END'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'DHCP_END_INTERNAL'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'DHCP_IPV6_ENABLE'</span><span class="p">:</span> <span class="s">'DHCPv4'</span><span class="p">,</span>
              <span class="s">'DHCP_IPV6_ENABLE_INTERNAL'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'DHCP_START'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'DHCP_START_INTERNAL'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'DNS_SERVER_IP_LIST'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'DNS_SERVER_VRF'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'ENABLE_AAA'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ENABLE_AGENT'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ENABLE_DEFAULT_QUEUING_POLICY'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ENABLE_EVPN'</span><span class="p">:</span> <span class="s">'true'</span><span class="p">,</span>
              <span class="s">'ENABLE_FABRIC_VPC_DOMAIN_ID'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ENABLE_FABRIC_VPC_DOMAIN_ID_PREV'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ENABLE_MACSEC'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ENABLE_NGOAM'</span><span class="p">:</span> <span class="s">'true'</span><span class="p">,</span>
              <span class="s">'ENABLE_NXAPI'</span><span class="p">:</span> <span class="s">'true'</span><span class="p">,</span>
              <span class="s">'ENABLE_NXAPI_HTTP'</span><span class="p">:</span> <span class="s">'true'</span><span class="p">,</span>
              <span class="s">'ENABLE_PBR'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ENABLE_TENANT_DHCP'</span><span class="p">:</span> <span class="s">'true'</span><span class="p">,</span>
              <span class="s">'ENABLE_TRM'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ENABLE_VPC_PEER_LINK_NATIVE_VLAN'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'EXTRA_CONF_INTRA_LINKS'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'EXTRA_CONF_LEAF'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'EXTRA_CONF_SPINE'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'FABRIC_INTERFACE_TYPE'</span><span class="p">:</span> <span class="s">'p2p'</span><span class="p">,</span>
              <span class="s">'FABRIC_MTU'</span><span class="p">:</span> <span class="s">'9216'</span><span class="p">,</span>
              <span class="s">'FABRIC_MTU_PREV'</span><span class="p">:</span> <span class="s">'9216'</span><span class="p">,</span>
              <span class="s">'FABRIC_NAME'</span><span class="p">:</span> <span class="s">'akl-fabric-01'</span><span class="p">,</span>
              <span class="s">'FABRIC_TYPE'</span><span class="p">:</span> <span class="s">'Switch_Fabric'</span><span class="p">,</span>
              <span class="s">'FABRIC_VPC_DOMAIN_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'FABRIC_VPC_DOMAIN_ID_PREV'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'FABRIC_VPC_QOS'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'FABRIC_VPC_QOS_POLICY_NAME'</span><span class="p">:</span> <span class="s">'spine_qos_for_fabric_vpc_peering'</span><span class="p">,</span>
              <span class="s">'FEATURE_PTP'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'FEATURE_PTP_INTERNAL'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'FF'</span><span class="p">:</span> <span class="s">'Easy_Fabric'</span><span class="p">,</span>
              <span class="s">'GRFIELD_DEBUG_FLAG'</span><span class="p">:</span> <span class="s">'Enable'</span><span class="p">,</span>
              <span class="s">'HD_TIME'</span><span class="p">:</span> <span class="s">'180'</span><span class="p">,</span>
              <span class="s">'IBGP_PEER_TEMPLATE'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'IBGP_PEER_TEMPLATE_LEAF'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'ISIS_AUTH_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'ISIS_AUTH_KEY'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'ISIS_AUTH_KEYCHAIN_KEY_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'ISIS_AUTH_KEYCHAIN_NAME'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'ISIS_LEVEL'</span><span class="p">:</span> <span class="s">'level-2'</span><span class="p">,</span>
              <span class="s">'ISIS_P2P_ENABLE'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'L2_HOST_INTF_MTU'</span><span class="p">:</span> <span class="s">'9216'</span><span class="p">,</span>
              <span class="s">'L2_HOST_INTF_MTU_PREV'</span><span class="p">:</span> <span class="s">'9216'</span><span class="p">,</span>
              <span class="s">'L2_SEGMENT_ID_RANGE'</span><span class="p">:</span> <span class="s">'30000-49000'</span><span class="p">,</span>
              <span class="s">'L3VNI_MCAST_GROUP'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'L3_PARTITION_ID_RANGE'</span><span class="p">:</span> <span class="s">'50000-59000'</span><span class="p">,</span>
              <span class="s">'LINK_STATE_ROUTING'</span><span class="p">:</span> <span class="s">'ospf'</span><span class="p">,</span>
              <span class="s">'LINK_STATE_ROUTING_TAG'</span><span class="p">:</span> <span class="s">'UNDERLAY'</span><span class="p">,</span>
              <span class="s">'LINK_STATE_ROUTING_TAG_PREV'</span><span class="p">:</span> <span class="s">'UNDERLAY'</span><span class="p">,</span>
              <span class="s">'LOOPBACK0_IPV6_RANGE'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'LOOPBACK0_IP_RANGE'</span><span class="p">:</span> <span class="s">'10.2.0.0/22'</span><span class="p">,</span>
              <span class="s">'LOOPBACK1_IPV6_RANGE'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'LOOPBACK1_IP_RANGE'</span><span class="p">:</span> <span class="s">'10.3.0.0/22'</span><span class="p">,</span>
              <span class="s">'MACSEC_ALGORITHM'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MACSEC_CIPHER_SUITE'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MACSEC_FALLBACK_ALGORITHM'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MACSEC_FALLBACK_KEY_STRING'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MACSEC_KEY_STRING'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MACSEC_REPORT_TIMER'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MGMT_GW'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MGMT_GW_INTERNAL'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MGMT_PREFIX'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MGMT_PREFIX_INTERNAL'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MGMT_V6PREFIX'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MGMT_V6PREFIX_INTERNAL'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MPLS_HANDOFF'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'MPLS_LB_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MPLS_LOOPBACK_IP_RANGE'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MSO_CONNECTIVITY_DEPLOYED'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MSO_CONTROLER_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MSO_SITE_GROUP_NAME'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MSO_SITE_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'MULTICAST_GROUP_SUBNET'</span><span class="p">:</span> <span class="s">'239.1.1.0/25'</span><span class="p">,</span>
              <span class="s">'NETWORK_VLAN_RANGE'</span><span class="p">:</span> <span class="s">'2300-2999'</span><span class="p">,</span>
              <span class="s">'NTP_SERVER_IP_LIST'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'NTP_SERVER_VRF'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'NVE_LB_ID'</span><span class="p">:</span> <span class="s">'1'</span><span class="p">,</span>
              <span class="s">'OSPF_AREA_ID'</span><span class="p">:</span> <span class="s">'0.0.0.0'</span><span class="p">,</span>
              <span class="s">'OSPF_AUTH_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'OSPF_AUTH_KEY'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'OSPF_AUTH_KEY_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'PHANTOM_RP_LB_ID1'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'PHANTOM_RP_LB_ID2'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'PHANTOM_RP_LB_ID3'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'PHANTOM_RP_LB_ID4'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'PIM_HELLO_AUTH_ENABLE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'PIM_HELLO_AUTH_KEY'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'POWER_REDUNDANCY_MODE'</span><span class="p">:</span> <span class="s">'ps-redundant'</span><span class="p">,</span>
              <span class="s">'PREMSO_PARENT_FABRIC'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'PTP_DOMAIN_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'PTP_LB_ID'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'REPLICATION_MODE'</span><span class="p">:</span> <span class="s">'Multicast'</span><span class="p">,</span>
              <span class="s">'ROUTER_ID_RANGE'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'ROUTE_MAP_SEQUENCE_NUMBER_RANGE'</span><span class="p">:</span> <span class="s">'1-65534'</span><span class="p">,</span>
              <span class="s">'RP_COUNT'</span><span class="p">:</span> <span class="s">'2'</span><span class="p">,</span>
              <span class="s">'RP_LB_ID'</span><span class="p">:</span> <span class="s">'254'</span><span class="p">,</span>
              <span class="s">'RP_MODE'</span><span class="p">:</span> <span class="s">'asm'</span><span class="p">,</span>
              <span class="s">'RR_COUNT'</span><span class="p">:</span> <span class="s">'2'</span><span class="p">,</span>
              <span class="s">'SERVICE_NETWORK_VLAN_RANGE'</span><span class="p">:</span> <span class="s">'3000-3199'</span><span class="p">,</span>
              <span class="s">'SITE_ID'</span><span class="p">:</span> <span class="s">'65001'</span><span class="p">,</span>
              <span class="s">'SNMP_SERVER_HOST_TRAP'</span><span class="p">:</span> <span class="s">'true'</span><span class="p">,</span>
              <span class="s">'SPINE_COUNT'</span><span class="p">:</span> <span class="s">'2'</span><span class="p">,</span>
              <span class="s">'SSPINE_ADD_DEL_DEBUG_FLAG'</span><span class="p">:</span> <span class="s">'Disable'</span><span class="p">,</span>
              <span class="s">'SSPINE_COUNT'</span><span class="p">:</span> <span class="s">'0'</span><span class="p">,</span>
              <span class="s">'STATIC_UNDERLAY_IP_ALLOC'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'STRICT_CC_MODE'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'SUBINTERFACE_RANGE'</span><span class="p">:</span> <span class="s">'2-511'</span><span class="p">,</span>
              <span class="s">'SUBNET_RANGE'</span><span class="p">:</span> <span class="s">'10.4.0.0/16'</span><span class="p">,</span>
              <span class="s">'SUBNET_TARGET_MASK'</span><span class="p">:</span> <span class="s">'30'</span><span class="p">,</span>
              <span class="s">'SYSLOG_SERVER_IP_LIST'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'SYSLOG_SERVER_VRF'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'SYSLOG_SEV'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'TCAM_ALLOCATION'</span><span class="p">:</span> <span class="s">'true'</span><span class="p">,</span>
              <span class="s">'UNDERLAY_IS_V6'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'USE_LINK_LOCAL'</span><span class="p">:</span> <span class="s">'true'</span><span class="p">,</span>
              <span class="s">'V6_SUBNET_RANGE'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'V6_SUBNET_TARGET_MASK'</span><span class="p">:</span> <span class="s">'126'</span><span class="p">,</span>
              <span class="s">'VPC_AUTO_RECOVERY_TIME'</span><span class="p">:</span> <span class="s">'360'</span><span class="p">,</span>
              <span class="s">'VPC_DELAY_RESTORE'</span><span class="p">:</span> <span class="s">'150'</span><span class="p">,</span>
              <span class="s">'VPC_DELAY_RESTORE_TIME'</span><span class="p">:</span> <span class="s">'60'</span><span class="p">,</span>
              <span class="s">'VPC_DOMAIN_ID_RANGE'</span><span class="p">:</span> <span class="s">'1-1000'</span><span class="p">,</span>
              <span class="s">'VPC_ENABLE_IPv6_ND_SYNC'</span><span class="p">:</span> <span class="s">'true'</span><span class="p">,</span>
              <span class="s">'VPC_PEER_KEEP_ALIVE_OPTION'</span><span class="p">:</span> <span class="s">'management'</span><span class="p">,</span>
              <span class="s">'VPC_PEER_LINK_PO'</span><span class="p">:</span> <span class="s">'500'</span><span class="p">,</span>
              <span class="s">'VPC_PEER_LINK_VLAN'</span><span class="p">:</span> <span class="s">'3600'</span><span class="p">,</span>
              <span class="s">'VRF_LITE_AUTOCONFIG'</span><span class="p">:</span> <span class="s">'Manual'</span><span class="p">,</span>
              <span class="s">'VRF_VLAN_RANGE'</span><span class="p">:</span> <span class="s">'2000-2299'</span><span class="p">,</span>
              <span class="s">'abstract_anycast_rp'</span><span class="p">:</span> <span class="s">'anycast_rp'</span><span class="p">,</span>
              <span class="s">'abstract_bgp'</span><span class="p">:</span> <span class="s">'base_bgp'</span><span class="p">,</span>
              <span class="s">'abstract_bgp_neighbor'</span><span class="p">:</span> <span class="s">'evpn_bgp_rr_neighbor'</span><span class="p">,</span>
              <span class="s">'abstract_bgp_rr'</span><span class="p">:</span> <span class="s">'evpn_bgp_rr'</span><span class="p">,</span>
              <span class="s">'abstract_dhcp'</span><span class="p">:</span> <span class="s">'base_dhcp'</span><span class="p">,</span>
              <span class="s">'abstract_extra_config_bootstrap'</span><span class="p">:</span> <span class="s">'extra_config_bootstrap_11_1'</span><span class="p">,</span>
              <span class="s">'abstract_extra_config_leaf'</span><span class="p">:</span> <span class="s">'extra_config_leaf'</span><span class="p">,</span>
              <span class="s">'abstract_extra_config_spine'</span><span class="p">:</span> <span class="s">'extra_config_spine'</span><span class="p">,</span>
              <span class="s">'abstract_feature_leaf'</span><span class="p">:</span> <span class="s">'base_feature_leaf_upg'</span><span class="p">,</span>
              <span class="s">'abstract_feature_spine'</span><span class="p">:</span> <span class="s">'base_feature_spine_upg'</span><span class="p">,</span>
              <span class="s">'abstract_isis'</span><span class="p">:</span> <span class="s">'base_isis_level2'</span><span class="p">,</span>
              <span class="s">'abstract_isis_interface'</span><span class="p">:</span> <span class="s">'isis_interface'</span><span class="p">,</span>
              <span class="s">'abstract_loopback_interface'</span><span class="p">:</span> <span class="s">'int_fabric_loopback_11_1'</span><span class="p">,</span>
              <span class="s">'abstract_multicast'</span><span class="p">:</span> <span class="s">'base_multicast_11_1'</span><span class="p">,</span>
              <span class="s">'abstract_ospf'</span><span class="p">:</span> <span class="s">'base_ospf'</span><span class="p">,</span>
              <span class="s">'abstract_ospf_interface'</span><span class="p">:</span> <span class="s">'ospf_interface_11_1'</span><span class="p">,</span>
              <span class="s">'abstract_pim_interface'</span><span class="p">:</span> <span class="s">'pim_interface'</span><span class="p">,</span>
              <span class="s">'abstract_route_map'</span><span class="p">:</span> <span class="s">'route_map'</span><span class="p">,</span>
              <span class="s">'abstract_routed_host'</span><span class="p">:</span> <span class="s">'int_routed_host_11_1'</span><span class="p">,</span>
              <span class="s">'abstract_trunk_host'</span><span class="p">:</span> <span class="s">'int_trunk_host_11_1'</span><span class="p">,</span>
              <span class="s">'abstract_vlan_interface'</span><span class="p">:</span> <span class="s">'int_fabric_vlan_11_1'</span><span class="p">,</span>
              <span class="s">'abstract_vpc_domain'</span><span class="p">:</span> <span class="s">'base_vpc_domain_11_1'</span><span class="p">,</span>
              <span class="s">'default_network'</span><span class="p">:</span> <span class="s">'Default_Network_Universal'</span><span class="p">,</span>
              <span class="s">'default_vrf'</span><span class="p">:</span> <span class="s">'Default_VRF_Universal'</span><span class="p">,</span>
              <span class="s">'enableRealTimeBackup'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'enableScheduledBackup'</span><span class="p">:</span> <span class="s">'false'</span><span class="p">,</span>
              <span class="s">'network_extension_template'</span><span class="p">:</span> <span class="s">'Default_Network_Extension_Universal'</span><span class="p">,</span>
              <span class="s">'scheduledTime'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'software_image'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
              <span class="s">'temp_anycast_gateway'</span><span class="p">:</span> <span class="s">'anycast_gateway'</span><span class="p">,</span>
              <span class="s">'temp_vpc_domain_mgmt'</span><span class="p">:</span> <span class="s">'vpc_domain_mgmt'</span><span class="p">,</span>
              <span class="s">'temp_vpc_peer_link'</span><span class="p">:</span> <span class="s">'int_vpc_peer_link_po_11_1'</span><span class="p">,</span>
              <span class="s">'vrf_extension_template'</span><span class="p">:</span> <span class="s">'Default_VRF_Extension_Universal'</span><span class="p">},</span>
  <span class="s">'provisionMode'</span><span class="p">:</span> <span class="s">'DCNMTopDown'</span><span class="p">,</span>
  <span class="s">'replicationMode'</span><span class="p">:</span> <span class="s">'Multicast'</span><span class="p">,</span>
  <span class="s">'siteId'</span><span class="p">:</span> <span class="s">'65001'</span><span class="p">,</span>
  <span class="s">'templateName'</span><span class="p">:</span> <span class="s">'Easy_Fabric_11_1'</span><span class="p">,</span>
  <span class="s">'vrfExtensionTemplate'</span><span class="p">:</span> <span class="s">'Default_VRF_Extension_Universal'</span><span class="p">,</span>
  <span class="s">'vrfTemplate'</span><span class="p">:</span> <span class="s">'Default_VRF_Universal'</span><span class="p">},</span>
 <span class="p">{</span><span class="s">'createdOn'</span><span class="p">:</span> <span class="mi">1620121501616</span><span class="p">,</span>
</code></pre></div></div>
<p>We’ve retrieved a lot of information from the above API calls and dictionary keys, including software versions, models, hostnames, uptime, BGP ASN, Fabric IP, VRF VLAN ranges that we can begin working with.</p>

<h2 id="325--django-model-database-table-definition">3.2.5  Django Model (Database Table) Definition</h2>

<p>Create our models for DCNM devices in <em>dcnm/models.py</em> and define columns/entries for the dictionary keys of interest:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create your models here.
</span><span class="k">class</span> <span class="nc">dcnm_network_device</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">dcnm_addr</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">asn</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">deviceType</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">fabricId</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">fabricName</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">fabricTechnology</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">fabricType</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">networkTemplate</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">ADVERTISE_PIP_BGP</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">ANYCAST_GW_MAC</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">ANYCAST_RP_IP_RANGE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">BFD_ENABLE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">BFD_AUTH_ENABLE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">BGP_AS</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">BGP_AUTH_ENABLE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">DCI_SUBNET_RANGE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">DCI_SUBNET_TARGET_MASK</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">DHCP_ENABLE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">ENABLE_EVPN</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">ENABLE_NXAPI</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">FABRIC_INTERFACE_TYPE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">FABRIC_MTU</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">FABRIC_NAME</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">L2_SEGMENT_ID_RANGE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">L3_PARTITION_ID_RANGE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">LINK_STATE_ROUTING</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">LINK_STATE_ROUTING_TAG</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">LOOPBACK0_IP_RANGE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">LOOPBACK1_IP_RANGE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">MULTICAST_GROUP_SUBNET</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">NETWORK_VLAN_RANGE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">OSPF_AREA_ID</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">OSPF_AUTH_ENABLE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">REPLICATION_MODE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">RR_COUNT</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">SERVICE_NETWORK_VLAN_RANGE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">SUBNET_RANGE</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">replicationMode</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">templateName</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">last_updated</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">timezone</span><span class="p">.</span><span class="n">now</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">switch_name</span>

<span class="k">class</span> <span class="nc">dcnm_network_switch</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">dcnm_addr</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">activeSupSlot</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">availPorts</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">consistencyState</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">cpuUsage</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">fabricName</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">health</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">hostName</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">ipAddress</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">isVpcConfigured</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">keepAliveState</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">'None'</span><span class="p">)</span>
    <span class="n">licenseDetail</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">licenseViolation</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">logicalName</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">managable</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">memoryUsage</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">network</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">numberOfPorts</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">peer</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">present</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">release</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">serialNumber</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">upTime</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">BigIntegerField</span><span class="p">()</span>
    <span class="n">vendor</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">vpcDomain</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">last_updated</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">timezone</span><span class="p">.</span><span class="n">now</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">switch_name</span>
</code></pre></div></div>
<p>Commit the models to the database:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span> <span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">makemigrations</span> <span class="n">dcnm</span>
<span class="n">Migrations</span> <span class="k">for</span> <span class="s">'dcnm'</span><span class="p">:</span>
  <span class="n">dcnm</span><span class="o">/</span><span class="n">migrations</span><span class="o">/</span><span class="mi">0001</span><span class="n">_initial</span><span class="p">.</span><span class="n">py</span>
    <span class="o">-</span> <span class="n">Create</span> <span class="n">model</span> <span class="n">dcnm_network_device</span>
    <span class="o">-</span> <span class="n">Create</span> <span class="n">model</span> <span class="n">dcnm_network_switch</span>
<span class="o">%</span> <span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">migrate</span> <span class="n">dcnm</span>       
<span class="n">Operations</span> <span class="n">to</span> <span class="n">perform</span><span class="p">:</span>
  <span class="n">Apply</span> <span class="nb">all</span> <span class="n">migrations</span><span class="p">:</span> <span class="n">dcnm</span>
</code></pre></div></div>

<h3 id="3251-writing-output-to-database-with-djangos-database-api">3.2.5.1 Writing output to Database with Djangos Database API</h3>
<p>When satisfied with above API calls:</p>
<ul>
  <li>Import our new dcnm_network_device and dcnm_network_switch models into dcnm_api.py</li>
  <li>Iterate over each item in our list of output</li>
  <li>Map the keys of interest in the JSON dictionary output to our model’s fields</li>
  <li>Commit the entry to the database with <em>device_entry.save()</em></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">dcnm.models</span> <span class="kn">import</span> <span class="n">dcnm_network_device</span><span class="p">,</span> <span class="n">dcnm_network_switch</span>
<span class="k">def</span> <span class="nf">get_dcnm_network_device</span><span class="p">(</span><span class="n">query_class</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">devices</span> <span class="o">=</span> <span class="n">dcnm_http_get</span><span class="p">(</span><span class="n">query_class</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">device</span><span class="p">[</span><span class="s">'fabricType'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Switch_Fabric'</span><span class="p">:</span>
                        <span class="n">device_entry</span><span class="o">=</span><span class="n">dcnm_network_device</span><span class="p">(</span>
                            <span class="n">dcnm_addr</span> <span class="o">=</span> <span class="n">dcnm</span><span class="p">,</span>
                            <span class="n">asn</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'asn'</span><span class="p">],</span>
                            <span class="n">deviceType</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'deviceType'</span><span class="p">],</span>
                            <span class="n">fabricId</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'fabricId'</span><span class="p">],</span>
                            <span class="n">fabricName</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'fabricName'</span><span class="p">],</span>
                            <span class="n">fabricTechnology</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'fabricTechnology'</span><span class="p">],</span>
                            <span class="n">fabricType</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'fabricType'</span><span class="p">],</span>
                            <span class="nb">id</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'id'</span><span class="p">],</span>
                            <span class="n">networkTemplate</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'networkTemplate'</span><span class="p">],</span>
                            <span class="n">ADVERTISE_PIP_BGP</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'ADVERTISE_PIP_BGP'</span><span class="p">],</span>
                            <span class="n">ANYCAST_GW_MAC</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'ANYCAST_GW_MAC'</span><span class="p">],</span>
                            <span class="n">ANYCAST_RP_IP_RANGE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'ANYCAST_RP_IP_RANGE'</span><span class="p">],</span>
                            <span class="n">BFD_ENABLE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'BFD_ENABLE'</span><span class="p">],</span>
                            <span class="n">BFD_AUTH_ENABLE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'BFD_AUTH_ENABLE'</span><span class="p">],</span>
                            <span class="n">BGP_AS</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'BGP_AS'</span><span class="p">],</span>
                            <span class="n">BGP_AUTH_ENABLE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'BGP_AUTH_ENABLE'</span><span class="p">],</span>
                            <span class="n">DCI_SUBNET_RANGE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'DCI_SUBNET_RANGE'</span><span class="p">],</span>
                            <span class="n">DCI_SUBNET_TARGET_MASK</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'DCI_SUBNET_TARGET_MASK'</span><span class="p">],</span>
                            <span class="n">DHCP_ENABLE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'DHCP_ENABLE'</span><span class="p">],</span>
                            <span class="n">ENABLE_EVPN</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'ENABLE_EVPN'</span><span class="p">],</span>
                            <span class="n">ENABLE_NXAPI</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'ENABLE_NXAPI'</span><span class="p">],</span>
                            <span class="n">FABRIC_INTERFACE_TYPE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'FABRIC_INTERFACE_TYPE'</span><span class="p">],</span>
                            <span class="n">FABRIC_MTU</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'FABRIC_MTU'</span><span class="p">],</span>
                            <span class="n">FABRIC_NAME</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'FABRIC_NAME'</span><span class="p">],</span>
                            <span class="n">L2_SEGMENT_ID_RANGE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'L2_SEGMENT_ID_RANGE'</span><span class="p">],</span>
                            <span class="n">L3_PARTITION_ID_RANGE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'L3_PARTITION_ID_RANGE'</span><span class="p">],</span>
                            <span class="n">LINK_STATE_ROUTING</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'LINK_STATE_ROUTING'</span><span class="p">],</span>
                            <span class="n">LINK_STATE_ROUTING_TAG</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'LINK_STATE_ROUTING_TAG'</span><span class="p">],</span>
                            <span class="n">LOOPBACK0_IP_RANGE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'LOOPBACK0_IP_RANGE'</span><span class="p">],</span>
                            <span class="n">LOOPBACK1_IP_RANGE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'LOOPBACK1_IP_RANGE'</span><span class="p">],</span>
                            <span class="n">MULTICAST_GROUP_SUBNET</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'MULTICAST_GROUP_SUBNET'</span><span class="p">],</span>
                            <span class="n">NETWORK_VLAN_RANGE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'NETWORK_VLAN_RANGE'</span><span class="p">],</span>
                            <span class="n">OSPF_AREA_ID</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'OSPF_AREA_ID'</span><span class="p">],</span>
                            <span class="n">OSPF_AUTH_ENABLE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'OSPF_AUTH_ENABLE'</span><span class="p">],</span>
                            <span class="n">REPLICATION_MODE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'REPLICATION_MODE'</span><span class="p">],</span>
                            <span class="n">RR_COUNT</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'RR_COUNT'</span><span class="p">],</span>
                            <span class="n">SERVICE_NETWORK_VLAN_RANGE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'SERVICE_NETWORK_VLAN_RANGE'</span><span class="p">],</span>
                            <span class="n">SUBNET_RANGE</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'nvPairs'</span><span class="p">][</span><span class="s">'SUBNET_RANGE'</span><span class="p">],</span>
                            <span class="n">replicationMode</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'replicationMode'</span><span class="p">],</span>
                            <span class="n">templateName</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'templateName'</span><span class="p">])</span>
                        <span class="n">device_entry</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
                <span class="n">aci_model_pruner</span><span class="p">(</span><span class="n">dnac_network_device</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">(),</span> <span class="n">obj_type</span><span class="o">=</span><span class="s">"DCNM Fabric"</span><span class="p">,</span> <span class="n">retention_period</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">'Unable to query devices on DCNM {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">dcnm</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">get_dcnm_network_switch</span><span class="p">(</span><span class="n">query_class</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">devices</span> <span class="o">=</span> <span class="n">dcnm_http_get</span><span class="p">(</span><span class="n">query_class</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
            <span class="n">device_entry</span><span class="o">=</span><span class="n">dcnm_network_switch</span><span class="p">(</span>
                <span class="n">dcnm_addr</span> <span class="o">=</span> <span class="n">dcnm</span><span class="p">,</span>
                <span class="n">activeSupSlot</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'activeSupSlot'</span><span class="p">],</span>
                <span class="n">availPorts</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'availPorts'</span><span class="p">],</span>
                <span class="n">consistencyState</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'consistencyState'</span><span class="p">],</span>
                <span class="n">cpuUsage</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'cpuUsage'</span><span class="p">],</span>
                <span class="n">fabricName</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'fabricName'</span><span class="p">],</span>
                <span class="n">health</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'health'</span><span class="p">],</span>
                <span class="n">hostName</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'hostName'</span><span class="p">],</span>
                <span class="n">ipAddress</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'ipAddress'</span><span class="p">],</span>
                <span class="n">isVpcConfigured</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'isVpcConfigured'</span><span class="p">],</span>
                <span class="n">licenseViolation</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'licenseViolation'</span><span class="p">],</span>
                <span class="n">logicalName</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'logicalName'</span><span class="p">],</span>
                <span class="n">managable</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'managable'</span><span class="p">],</span>
                <span class="n">memoryUsage</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'memoryUsage'</span><span class="p">],</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'mode'</span><span class="p">],</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'model'</span><span class="p">],</span>
                <span class="n">network</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'network'</span><span class="p">],</span>
                <span class="n">numberOfPorts</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'numberOfPorts'</span><span class="p">],</span>
                <span class="n">present</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'present'</span><span class="p">],</span>
                <span class="n">release</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'release'</span><span class="p">],</span>
                <span class="n">serialNumber</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'serialNumber'</span><span class="p">],</span>
                <span class="n">upTime</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'upTime'</span><span class="p">],</span>
                <span class="n">vendor</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'vendor'</span><span class="p">],</span>
                <span class="n">vpcDomain</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s">'vpcDomain'</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="n">device_entry</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">aci_model_pruner</span><span class="p">(</span><span class="n">dnac_network_device</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">(),</span> <span class="n">obj_type</span><span class="o">=</span><span class="s">"DCNM Switch"</span><span class="p">,</span> <span class="n">retention_period</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Unable to query devices on DCNM {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">dcnm</span><span class="p">))</span>
</code></pre></div></div>

<p>Run the functions:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get_dcnm_network_switch</span><span class="p">(</span><span class="s">'/inventory/switches'</span><span class="p">)</span>
<span class="n">get_dcnm_network_device</span><span class="p">(</span><span class="s">'/control/fabrics'</span><span class="p">)</span>
</code></pre></div></div>

<p>As we did in the meraki tutorial, add the following to dcnm_api.py so that it knows where to find our django settings and model files:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Add your own path to django install location here
</span><span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">"/Users/jamespsullivan/Documents/grafana-cisco-demo/cisco_grafana/"</span><span class="p">)</span>

<span class="c1"># We need to import django configuration settings to write our API response using the django models API
</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'DJANGO_SETTINGS_MODULE'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'cisco_grafana.settings'</span>

<span class="kn">import</span> <span class="nn">django</span>
<span class="n">django</span><span class="p">.</span><span class="n">setup</span><span class="p">()</span>
</code></pre></div></div>
<p>Use PgAdmin to verify devices have been retrieved and written to the database
<img src="https://github.com/j-sulliman/j-sulliman.github.io/blob/master/images/DCNM_PGAdmin.png?raw=true" alt="pgAdmin" /></p>

<h2 id="326-grafana-visualisations">3.2.6 Grafana Visualisations</h2>

<h4 id="installation">Installation</h4>
<p>Refer to Tutuorial (2) Meraki for Grafana installation and setup instructions</p>

<p>Create a new dashboard and add a new panel - configure <strong>query options</strong> as below.  Note - if you don’t configure <strong>“aggregate: count”</strong> as shown, you’ll most likely receive an error.</p>

<p>Select PieChartv2 from the right, optionally change the PieChart type to <strong>donut</strong>, add the labels name, value and percent and give the chart a title.</p>

<p>Your preview pane should now look like below - click save and apply
<img src="https://github.com/j-sulliman/j-sulliman.github.io/blob/master/images/DCNM_Software_Versions.png?raw=true" alt="alt text" /></p>

<p>Add a new panel to display device health information:
<img src="https://github.com/j-sulliman/j-sulliman.github.io/blob/master/images/DCNM_Bar_Gauge.png?raw=true" alt="alt text" /></p>

<p>CPU and Memory utilisation can be monitored with a Gauge Panel as shown:
<img src="https://github.com/j-sulliman/j-sulliman.github.io/blob/master/images/DCNM_CPU_Gauge.png?raw=true" alt="alt text" /></p>

<ul>
  <li>Return to the dashboard and add another panel, again select the <strong>dcnm_dcnm_network_switch</strong> table.</li>
  <li>From the right hand pane, select <strong>table</strong></li>
  <li>In the <strong>query options</strong>, select “format as: table”</li>
  <li>Add columns of interest to the table</li>
</ul>

<p>If you’ve managed to follow this tutorial successfully, your DCNM panel should now look like below:
<img src="https://github.com/j-sulliman/j-sulliman.github.io/blob/master/images/DCNM_Dashboard.png?raw=true" alt="alt text" /></p>

<h2 id="327-wrap-up">3.2.7 Wrap Up</h2>

<p>That’s it for this week’s update thanks for reading through.  We’ve only scratched the surface of DCNM APIs and visualisations, but I hope that there’s some useful content you can use to continue exploring Cisco APIs and opensource software such as grafana.</p>

<p>I’ll update this site’s as I cover remaining architectures - SDWAN and vManage up next.</p>

<p>Jamie</p>

  </div><a class="u-url" href="/2021/05/05/Part-3.2-DCNM-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Jamie Sullivan&#39;s Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Jamie Sullivan&#39;s Blog</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/j-sulliman"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">j-sulliman</span></a></li><li><a href="https://www.linkedin.com/in/jamie-sullivan-71575421"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">jamie-sullivan-71575421</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Personal Blog for Networking, Datacenter and automation / programmability.  All content is my own and does not represent the views of my employer.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
