<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2709176-10"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2709176-10', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Nexus to ACI Configuration Importer | Jamie Sullivan’s Blog</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Nexus to ACI Configuration Importer" /><meta property="og:locale" content="en_US" /><meta name="description" content="Network automation, Data Center, Python, Infrastructure-as-code" /><meta property="og:description" content="Network automation, Data Center, Python, Infrastructure-as-code" /><link rel="canonical" href="http://localhost:4000/docs/NetDevOps-Other/aci-configuration-importer/" /><meta property="og:url" content="http://localhost:4000/docs/NetDevOps-Other/aci-configuration-importer/" /><meta property="og:site_name" content="Jamie Sullivan’s Blog" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Nexus to ACI Configuration Importer" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Network automation, Data Center, Python, Infrastructure-as-code","headline":"Nexus to ACI Configuration Importer","url":"http://localhost:4000/docs/NetDevOps-Other/aci-configuration-importer/"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Jamie Sullivan's Blog </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/NetDevOps-Other" class="nav-list-link">NetDevOps - all other articles</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/NetDevOps-Other/Intersight-automation-of-delivery-documentation/" class="nav-list-link">Intersight - Automation of Delivery Documentation</a><li class="nav-list-item active"><a href="http://localhost:4000/docs/NetDevOps-Other/aci-configuration-importer/" class="nav-list-link active">Nexus to ACI Configuration Importer</a><li class="nav-list-item "><a href="http://localhost:4000/docs/NetDevOps-Other/meraki-as-built-generator/" class="nav-list-link">Meraki As-Built Generator</a><li class="nav-list-item "><a href="http://localhost:4000/docs/NetDevOps-Other/provisioning-ucs-from-spreadsheet/" class="nav-list-link">Provisioning UCS from Spreadsheet</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/infrastructure-as-code" class="nav-list-link">Infrastructure as Code</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/infrastructure-as-code/ansible-dcnm/" class="nav-list-link">1. Deploying an EVPN and VXLAN Fabric with Ansible</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/grafana" class="nav-list-link">Grafana Django and Cisco APIs Dashboard</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/Introduction/" class="nav-list-link">1. Introduction</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/meraki/" class="nav-list-link">2. Building a Meraki Dashboard</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/dcnm-lab/" class="nav-list-link">3.1 DCNM Lab Build</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/dcnm-dashboard/" class="nav-list-link">3.2 Building a DCNM Dashboard</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/SDWAN-Lab-Build/" class="nav-list-link">4.1 Cisco SDWAN Lab Build</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/Cisco-SDWAN-Grafana/" class="nav-list-link">4.2 Cisco SDWAN and vManage Dashboard</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/OpenVuln-API/" class="nav-list-link">5.0 Cisco Vulnerability and PSIRTS Dashboard</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/DNAC-Grafana/" class="nav-list-link">6.0 Cisco DNAC Dashboard</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/ACI-Dashboard/" class="nav-list-link">7.0 Cisco ACI Dashboard</a></ul><li class="nav-list-item"><a href="http://localhost:4000/docs/observability/dotnet-containers" class="nav-list-link">Part 1 - Instrumenting a dotnet6 container with appdynamics</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/SRE" class="nav-list-link">SRE - Learnings and Notes</a><ul class="nav-list "></ul></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="https://www.linkedin.com/in/jamie-sullivan-71575421/" class="site-button" > Contact me on LinkedIn </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/NetDevOps-Other">NetDevOps - all other articles</a><li class="breadcrumb-nav-list-item"><span>Nexus to ACI Configuration Importer</span></ol></nav><div id="main-content" class="main-content" role="main"><p><a href="https://developer.cisco.com/codeexchange/github/repo/j-sulliman/acici"><img src="https://static.production.devnetcloud.com/codeexchange/assets/images/devnet-published.svg" alt="published" /></a></p><h1 id="acici-automate-aci-configuration-of-legacy-logical-network"> <a href="#acici-automate-aci-configuration-of-legacy-logical-network" class="anchor-heading" aria-labelledby="acici-automate-aci-configuration-of-legacy-logical-network"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ACICI: Automate ACI configuration of Legacy Logical Network</h1><p>Imports L2 constructs (VLANs, SVIs and associated VRF) from Legacy NXOS configuration, into ACI in a network centric approach (legacy vlan = ACI BD/EPG).</p><p>Script is VRF aware, EPGS/BDs will be grouped under Application Endpoint Groups, split by VRF. If there are no VRFs in legacy, all EPGs/BDS will be assigned the “DEFAULT” vrf. It’s up to you to create the fabric access policies.</p><p>EPGS are created with a static path binding to the legacy switch - the hostname from configuration file is used for this. Legacy items are imported into Django models DB Bulk clean/naming of data (e.g EPG/BD/VRFs naming convention)</p><p>Optional editing and review of imported data through Django admin front end (i.e. http 127.0.0.1:8080/admin)</p><p>Post imported objects to APIC (EPGS are be default included in a preferred group)</p><p><img src="https://github.com/j-sulliman/acici/blob/master/overview.png?raw=true" alt="overview" /></p><h1 id="demo"> <a href="#demo" class="anchor-heading" aria-labelledby="demo"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Demo</h1><iframe width="700" height="400" src="https://www.youtube.com/embed/V_Qyy2QHGVY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen=""></iframe><h1 id="setup"> <a href="#setup" class="anchor-heading" aria-labelledby="setup"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setup</h1><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3 -m venv venv

$ source venv/bin/activate

$ git init

$ git pull https://github.com/j-sulliman/acici.git

Install the required dependencies:

$ pip3 install -r requirements.txt
</code></pre></div></div><h1 id="start-django-server"> <a href="#start-django-server" class="anchor-heading" aria-labelledby="start-django-server"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Start Django Server</h1><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3 manage.py runserver 0:8080

Watching for file changes with StatReloader
Performing system checks...

System check identified no issues (0 silenced).
July 18, 2019 - 13:17:42
Django version 2.2.2, using settings 'nxos_aci.settings'
Starting development server at http://0:8080/
Quit the server with CONTROL-C.
</code></pre></div></div><h1 id="logon-and-import-nxos-file"> <a href="#logon-and-import-nxos-file" class="anchor-heading" aria-labelledby="logon-and-import-nxos-file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Logon and Import NXOS file</h1><p>i.e. http://127.0.0.1:8080 Login as admin/C1sc0123</p><p>Menu –&gt; Upload Config File</p><p><img src="https://github.com/j-sulliman/acici/blob/master/acici-upload.png?raw=true" alt="alt text" /></p><p>Provide the defaults for configuration naming convention and BD construct. BD mode in most cases should be l2 which will enable ARP and BUM flooding. L3 mode will enable unicast routing and configure the SVI address as a BD Subnet. EPGs will be created as “Preferred group - Include” members.</p><p><img src="https://github.com/j-sulliman/acici/blob/master/tenant-defaults.png?raw=true" alt="alt text" /></p><p>View and Edit the Imported configuration <img src="https://github.com/j-sulliman/acici/blob/master/imported-epgs.png?raw=true" alt="alt text" /></p><p>Enter the APIC connection info and submit <img src="https://github.com/j-sulliman/acici/blob/master/push-to-apic.png?raw=true" alt="alt text" /></p><p>View the resulting JSON and HTTP Post status code <img src="https://github.com/j-sulliman/acici/blob/master/epg-json.png?raw=true" alt="alt text" /></p><ul><li>Object configuration and DN/URL can be used with other REST API clients - i.e. postman, curl, or paste directly into APIC</ul><p>Check the APIC <img src="https://github.com/j-sulliman/acici/blob/master/apic-import.png?raw=true" alt="alt text" /></p><h1 id="create-associated-fabric-access-policies-and-l3os-manually"> <a href="#create-associated-fabric-access-policies-and-l3os-manually" class="anchor-heading" aria-labelledby="create-associated-fabric-access-policies-and-l3os-manually"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create associated fabric access policies and L3Os manually</h1><p>Rationale - items like Physical domain, vlan pools to legacy network will likely only be configured once.<br /> Fabric access policies therefore less far less time consuming than tenant policy.</p><p>L3O configuration is environment dependant.</p><h1 id="disclaimer"> <a href="#disclaimer" class="anchor-heading" aria-labelledby="disclaimer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Disclaimer</h1><p>Tested against NXOS 7.X configuration files, may work with IOS but needs testing. Use at your own risk - recommend dry-run against a simulator or non-prod APIC</p><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">All content and views expressed here is my own and does not represent the views of my employer.</p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0 mr-2"> Page last modified: <span class="d-inline-block">Jul 19 2021 at 08:00 AM</span>.</p></div></footer></div></div></div>
