<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2709176-10"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2709176-10', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>3.1 DCNM Lab Build | Jamie Sullivan’s Blog</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="3.1 DCNM Lab Build" /><meta property="og:locale" content="en_US" /><meta name="description" content="Network automation, Data Center, Python, Infrastructure-as-code" /><meta property="og:description" content="Network automation, Data Center, Python, Infrastructure-as-code" /><link rel="canonical" href="http://localhost:4000/docs/grafana/dcnm-lab/" /><meta property="og:url" content="http://localhost:4000/docs/grafana/dcnm-lab/" /><meta property="og:site_name" content="Jamie Sullivan’s Blog" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="3.1 DCNM Lab Build" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Network automation, Data Center, Python, Infrastructure-as-code","headline":"3.1 DCNM Lab Build","url":"http://localhost:4000/docs/grafana/dcnm-lab/"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Jamie Sullivan's Blog </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/NetDevOps-Other" class="nav-list-link">NetDevOps - all other articles</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/NetDevOps-Other/Intersight-automation-of-delivery-documentation/" class="nav-list-link">Intersight - Automation of Delivery Documentation</a><li class="nav-list-item "><a href="http://localhost:4000/docs/NetDevOps-Other/aci-configuration-importer/" class="nav-list-link">Nexus to ACI Configuration Importer</a><li class="nav-list-item "><a href="http://localhost:4000/docs/NetDevOps-Other/meraki-as-built-generator/" class="nav-list-link">Meraki As-Built Generator</a><li class="nav-list-item "><a href="http://localhost:4000/docs/NetDevOps-Other/provisioning-ucs-from-spreadsheet/" class="nav-list-link">Provisioning UCS from Spreadsheet</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/infrastructure-as-code" class="nav-list-link">Infrastructure as Code</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/infrastructure-as-code/ansible-dcnm/" class="nav-list-link">1. Deploying an EVPN and VXLAN Fabric with Ansible</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/grafana" class="nav-list-link">Grafana Django and Cisco APIs Dashboard</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/Introduction/" class="nav-list-link">1. Introduction</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/meraki/" class="nav-list-link">2. Building a Meraki Dashboard</a><li class="nav-list-item active"><a href="http://localhost:4000/docs/grafana/dcnm-lab/" class="nav-list-link active">3.1 DCNM Lab Build</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/dcnm-dashboard/" class="nav-list-link">3.2 Building a DCNM Dashboard</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/SDWAN-Lab-Build/" class="nav-list-link">4.1 Cisco SDWAN Lab Build</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/Cisco-SDWAN-Grafana/" class="nav-list-link">4.2 Cisco SDWAN and vManage Dashboard</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/OpenVuln-API/" class="nav-list-link">5.0 Cisco Vulnerability and PSIRTS Dashboard</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/DNAC-Grafana/" class="nav-list-link">6.0 Cisco DNAC Dashboard</a><li class="nav-list-item "><a href="http://localhost:4000/docs/grafana/ACI-Dashboard/" class="nav-list-link">7.0 Cisco ACI Dashboard</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/SRE" class="nav-list-link">SRE - Learnings and Notes</a><ul class="nav-list "></ul><li class="nav-list-item"><a href="http://localhost:4000/docs/observability/dotnet-containers" class="nav-list-link">Part 1 - Instrumenting a dotnet6 container with appdynamics</a></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="https://www.linkedin.com/in/jamie-sullivan-71575421/" class="site-button" > Contact me on LinkedIn </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/grafana">Grafana Django and Cisco APIs Dashboard</a><li class="breadcrumb-nav-list-item"><span>3.1 DCNM Lab Build</span></ol></nav><div id="main-content" class="main-content" role="main"><h1 id="part-31-dcnm-and-vxlan-bgp-and-evpn-lab-with-nexus-9000v-overview"> <a href="#part-31-dcnm-and-vxlan-bgp-and-evpn-lab-with-nexus-9000v-overview" class="anchor-heading" aria-labelledby="part-31-dcnm-and-vxlan-bgp-and-evpn-lab-with-nexus-9000v-overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Part (3.1) DCNM and VXLAN BGP and EVPN Lab with Nexus 9000v Overview</h1><p>In this update we outline the virtual lab topology used as the sandbox to explore APIs and Visualisations with Grafana and DCNM. If you already have a DCNM environment available, you can skip this page and continue to Part 3.2.</p><h2 id="312-resources"> <a href="#312-resources" class="anchor-heading" aria-labelledby="312-resources"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.2 Resources</h2><ul><li><a href="https://developer.cisco.com/docs/data-center-network-manager/11-5-1/">DCNM REST API Reference Guide</a><li><a href="https://www.cisco.com/c/en/us/td/docs/dcn/dcnm/1151/configuration/lanfabric/cisco-dcnm-lanfabric-configuration-guide-1151/managing-greenfield-vxlan-fabric.html">Easy Provisioning of VXLAN BGP EVPN Fabrics</a><li><a href="https://www.cisco.com/c/en/us/td/docs/dcn/dcnm/1151/configuration/lanfabric/cisco-dcnm-lanfabric-configuration-guide-1151/border-provisioning-multisite.html">Auto-Provisioning Border Gateways with Multi-Site Domains</a><li><a href="https://www.cisco.com/c/en/us/products/collateral/switches/nexus-9000-series-switches/white-paper-c11-739942.html">VXLAN EVPN Multi-Site Design and Deployment Whitepaper</a><li><a href="https://www.cisco.com/c/en/us/td/docs/dcn/dcnm/1151/configuration/lanfabric/cisco-dcnm-lanfabric-configuration-guide-1151/border-provisioning-multisite.html">Cisco Communities - Data Center</a></ul><h3 id="3121-cisco-modelling-labs-gns3-and-eve-ng-deployment-guides"> <a href="#3121-cisco-modelling-labs-gns3-and-eve-ng-deployment-guides" class="anchor-heading" aria-labelledby="3121-cisco-modelling-labs-gns3-and-eve-ng-deployment-guides"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.2.1 Cisco Modelling Labs, GNS3 and EVE-NG Deployment Guides</h3><ul><li><a href="https://developer.cisco.com/docs/modeling-labs/#!cml-users-guide">Cisco Modelling Labs 2.1 User Guide</a><li><a href="https://gns3.com/marketplace/appliances/cisco-dcnm">GNS3 Market Place</a><li><a href="https://www.eve-ng.net/index.php/documentation/howtos/howto-add-cisco-dcnm-data-center-network-manager/">EVE-NG: DCNM How To</a></ul><h2 id="313-dcnm-vxlan-bgp-and-evpn-lab-overview"> <a href="#313-dcnm-vxlan-bgp-and-evpn-lab-overview" class="anchor-heading" aria-labelledby="313-dcnm-vxlan-bgp-and-evpn-lab-overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.3 DCNM VXLAN BGP and EVPN Lab Overview</h2><p>The Lab includes the following:</p><ul><li>2 x Fabrics <em>Auckland</em> and <em>Wellington</em>, each fabric has:<ul><li>2 x spines<li>2 x leafs<li>1 x Border Gateway for DCI between Fabrics<li>1 x ubuntu guest - connected to a leaf switch in each fabrics</ul><li>1 x ubuntu guest connected to the management network</ul><p><img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/DCNM_EVPN_Topology_1.png" alt="alt text" /></p><h3 id="3131-dcnm-vxlan-bgp-and-evpn-lab-virtual-appliances"> <a href="#3131-dcnm-vxlan-bgp-and-evpn-lab-virtual-appliances" class="anchor-heading" aria-labelledby="3131-dcnm-vxlan-bgp-and-evpn-lab-virtual-appliances"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.3.1 DCNM VXLAN BGP and EVPN Lab Virtual Appliances</h3><div class="table-wrapper"><table><thead><tr><th>Appliance<th>Image name<th>Version<th>Memory<th>CPU<th>Disk<th>Qty<tbody><tr><td>DCNM<td>dcnm-va.11.5.1.iso<td>11.5<td>24768MB<td>8vCPUs<td>100G<td>1<tr><td>n9000v<td>nexus9300v.9.3.7.qcow2<td>9.3.7<td>8096MB<td>2vCPUs<td>-<td>10<tr><td>Ubuntu Desktop<td>Ubuntu 20.10 (64bit).vmdk<td>20.10<td>1024MB<td>1vCPUs<td>-<td>3</table></div><p><strong>Note:</strong> DCNM minimum requirements are exactly that, <em>requirements</em> If CPU, Disk or memory for DCNM is under-provisioned, you’ll be redirected to <em>https://[DCNM-IP]:2443/resourceerror.html</em>. Shutdown the DCNM virtual-machine and assign the minimum virtual machine requirements as above.</p><h2 id="314-considerations"> <a href="#314-considerations" class="anchor-heading" aria-labelledby="314-considerations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.4 Considerations</h2><p>Note the following pre-requisites from the MSD configuration guide:</p><ul><li>The <em>underlay IP addresses across the fabrics</em>, the loopback 0 address and the loopback 1 address subnets should be <em>unique</em>.<li>Ensure that each fabric has a <em>unique IP address pool</em> to avoid duplicates.<li>Each fabric should have a <em>unique site ID and BGP AS number</em> associated and configured.<li>All fabrics should have the <em>same Anycast Gateway MAC</em> address.</ul><h2 id="315-base-configuration"> <a href="#315-base-configuration" class="anchor-heading" aria-labelledby="315-base-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.5 Base Configuration</h2><p>Configure the hostname, management address and boot image for each device:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conf t
interface mgmt 0
  ip address [192.168.200.229/24]
!
ip route 0.0.0.0 0.0.0.0 [192.168.200.1] vrf management
hostname [dc2-bdlf-001]
boot nxos bootflash:///nxos.9.3.7.bin
copy run st
</code></pre></div></div><p><strong>Note</strong> – With a DHCP assigned address on Mgmt0, you might encounter - <em>“Error during configuration read or intent”</em> error when Saving and Deploying configuration. Statically assigned IP addresses to Mgmt0 should resolve.</p><h2 id="316-site-1-auckland-fabric-deployment-and-the-easy_fabric-template"> <a href="#316-site-1-auckland-fabric-deployment-and-the-easy_fabric-template" class="anchor-heading" aria-labelledby="316-site-1-auckland-fabric-deployment-and-the-easy_fabric-template"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.6 Site 1 “Auckland Fabric” Deployment and the Easy_Fabric template</h2><p>From the <em>Control</em> menu, select <em>Fabric Builder</em>, <em>Create Fabric</em>, name the fabric and provide a BGP ASN <img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_1.png" alt="alt text" /></p><p>We’re using N9000v’s for our lab, Under advanced <strong>“Greenfield Cleanup”</strong> – select <strong>“enable”</strong></p><p>From the configuration guide: <em>“Greenfield Cleanup Option – Enable the switch cleanup option for switches imported into DCNM with Preserve-Config=No, without a switch reload. This option is typically recommended only for the fabric environments with Cisco Nexus 9000v Switches to improve on the switch clean up time.</em></p><p><img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_easy_frabric_2.png" alt="alt text" /></p><p>On the Resources tab – either accept defaults for the first fabric, or if connecting multiple sites, note the IP and VNI ranges as these will need to be unique to each site.</p><p>Defaults are fine for Manageability , Bootstrap, Configuration Backup tabs</p><h3 id="3161--add-switches-to-site-1-auckland-fabric"> <a href="#3161--add-switches-to-site-1-auckland-fabric" class="anchor-heading" aria-labelledby="3161--add-switches-to-site-1-auckland-fabric"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.6.1 Add switches to Site 1 “Auckland Fabric”</h3><p>Management address, username and password define in <em>base configuration</em> <img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_add_switches.png" alt="Add Switches" /></p><p>Select <em>manageable</em> switches and <strong>Import to Fabric</strong> <img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_add_switches_3.png" alt="Import Switches" /></p><p>Right click on spines and set roles, in my case I also have a border leaf that I added after the initial deployment, click <strong>“Save and Deploy”</strong> <img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_assign_roles.png" alt="Assign Roles" /></p><p>Deploy the Configuration <img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_push_config.png" alt="Deploy Config" /></p><h3 id="317-site-2-wellington-fabric-deployment-and-the-easy_fabric-template"> <a href="#317-site-2-wellington-fabric-deployment-and-the-easy_fabric-template" class="anchor-heading" aria-labelledby="317-site-2-wellington-fabric-deployment-and-the-easy_fabric-template"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.7 Site 2 “Wellington Fabric” Deployment and the Easy_Fabric template</h3><p>Create the fabric for the second site, defining unique subnet ranges and BGP ASNs as described in the pre-requisites</p><p><img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_fabric_two_1.png" alt="Add Switches" /></p><p>Define the spine and Border Gateway Roles as required and <em>Deploy Config</em> - site two should now be <strong>In Sync</strong> <img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_fabric_two_3.png" alt="Fabric Two" /></p><h3 id="318-multi-site-domain-msd-deployment"> <a href="#318-multi-site-domain-msd-deployment" class="anchor-heading" aria-labelledby="318-multi-site-domain-msd-deployment"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.8 Multi-Site Domain (MSD) Deployment</h3><p>To interconnect our two VXLAN EVPN fabrics together, we’ll use DCNM’s Multi-Site feature and MSD_Fabric template. This will provision the configuration required to deploy Datacenter interconnect (DCI) overlays to the border gateway switches (BGWs) defined previously.</p><p>The MSD feature will be the control point for overlay networks that are stretched between fabrics</p><h4 id="3181-fabric-definition"> <a href="#3181-fabric-definition" class="anchor-heading" aria-labelledby="3181-fabric-definition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.8.1 Fabric Definition</h4><p><img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/msd_1.png" alt="one" /></p><p><img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_msd_2.png" alt="two" /></p><p><img src="https://raw.githubusercontent.com/j-sulliman/j-sulliman.github.io/master/images/dcnm_msd_3.png" alt="three" /></p><h4 id="3182-fabric-members-and-operational-state"> <a href="#3182-fabric-members-and-operational-state" class="anchor-heading" aria-labelledby="3182-fabric-members-and-operational-state"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.8.2 Fabric Members and Operational State</h4><p>Click the tabular view to see a summarised table of all switches in the MSD Fabric: <img src="https://github.com/j-sulliman/j-sulliman.github.io/blob/master/images/DCNM_Tab_view.png?raw=true" alt="four" /></p><h2 id="319-verification"> <a href="#319-verification" class="anchor-heading" aria-labelledby="319-verification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.9 Verification</h2><p>The design guide outlines verification commands for VTEPs, fabric and DCI links and the EVPN control-plane and VXLAN data plane:</p><h3 id="3191-features"> <a href="#3191-features" class="anchor-heading" aria-labelledby="3191-features"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.9.1 Features</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dc1-leaf-001# show feature | grep enabled | exclude "not-run"
bgp                    1          enabled
dhcp                   1          enabled
hmm                    1          enabled
icam                   1          enabled
interface-vlan         1          enabled
lacp                   1          enabled
lldp                   1          enabled
ngoam                  1          enabled
nve                    1          enabled
nxapi                  1          enabled
ospf                   1          enabled
pim                    1          enabled
sshServer              1          enabled
vnseg_vlan             1          enabled
vpc                    1          enabled
</code></pre></div></div><h3 id="3192-nve-interface"> <a href="#3192-nve-interface" class="anchor-heading" aria-labelledby="3192-nve-interface"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.9.2 NVE interface</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dc1-leaf-001# show nve interface nve 1 detail
Interface: nve1, State: Up, encapsulation: VXLAN
 VPC Capability: VPC-VIP-Only [notified]
 Local Router MAC: 0c44.b700.1b08
 Host Learning Mode: Control-Plane
 Source-Interface: loopback1 (primary: 10.3.0.3, secondary: 10.3.0.1)
 Source Interface State: Up
 Virtual RMAC Advertisement: No
 NVE Flags:
 Interface Handle: 0x49000001
 Source Interface hold-down-time: 180
 Source Interface hold-up-time: 30
 Remaining hold-down time: 0 seconds
 Virtual Router MAC: 0200.0a03.0001
 Interface state: nve-intf-add-complete
</code></pre></div></div><h3 id="3193-vpc"> <a href="#3193-vpc" class="anchor-heading" aria-labelledby="3193-vpc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.9.3 vPC</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> dc1-leaf-001# show vpc brief
 Legend:
                 (*) - local vPC is down, forwarding via vPC peer-link

 vPC domain id                     : 1   
 Peer status                       : peer adjacency formed ok      
 vPC keep-alive status             : peer is alive                 
 Configuration consistency status  : success
 Per-vlan consistency status       : success                       
 Type-2 consistency status         : success
 vPC role                          : primary                       
 Number of vPCs configured         : 0   
 Peer Gateway                      : Enabled
 Dual-active excluded VLANs        : -
 Graceful Consistency Check        : Enabled
 Auto-recovery status              : Enabled, timer is off.(timeout = 360s)
 Delay-restore status              : Timer is off.(timeout = 150s)
 Delay-restore SVI status          : Timer is off.(timeout = 10s)
 Operational Layer3 Peer-router    : Disabled
 Virtual-peerlink mode             : Disabled

 vPC Peer-link status
 ---------------------------------------------------------------------
 id    Port   Status Active vlans    
 --    ----   ------ -------------------------------------------------
 1     Po500  up     1,3600
</code></pre></div></div><h3 id="3194-bgp"> <a href="#3194-bgp" class="anchor-heading" aria-labelledby="3194-bgp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.9.4 BGP</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dc1-spine-002# show bgp l2vpn evpn summary vrf all
BGP summary information for VRF default, address family L2VPN EVPN
BGP router identifier 10.2.0.4, local AS number 65001
BGP table version is 13, L2VPN EVPN config peers 3, capable peers 3
1 network entries and 1 paths using 244 bytes of memory
BGP attribute entries [1/172], BGP AS path entries [0/0]
BGP community entries [0/0], BGP clusterlist entries [0/0]

Neighbor        V    AS MsgRcvd MsgSent   TblVer  InQ OutQ Up/Down  State/PfxRcd
10.2.0.1        4 65001    2491    2491       13    0    0    1d17h 0         
10.2.0.2        4 65001    2491    2491       13    0    0    1d17h 0         
10.2.0.5        4 65001    1696    1698       13    0    0 17:45:00 1
</code></pre></div></div><h3 id="3195-evpn-fabric-links"> <a href="#3195-evpn-fabric-links" class="anchor-heading" aria-labelledby="3195-evpn-fabric-links"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.9.5 EVPN Fabric links</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dc1-bdlf-001# show nve multisite fabric-links
Interface      State
---------      -----
Ethernet1/1    Up   
Ethernet1/2    Up
</code></pre></div></div><h3 id="3196-evpn-dci-links"> <a href="#3196-evpn-dci-links" class="anchor-heading" aria-labelledby="3196-evpn-dci-links"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.9.6 EVPN DCI Links</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dc1-bdlf-001# show nve multisite dci-links
Interface      State
---------      -----
Ethernet1/3    Up  
</code></pre></div></div><h3 id="3197-designated-forwaders"> <a href="#3197-designated-forwaders" class="anchor-heading" aria-labelledby="3197-designated-forwaders"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.9.7 Designated Forwaders</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dc1-bdlf-001# show nve multisite fabric-links
Interface      State
---------      -----
Ethernet1/1    Up   
Ethernet1/2    Up   

dc1-bdlf-001# show nve e
ethernet-segment   evi                
dc1-bdlf-001# show nve ethernet-segment

ESI: 0300.0000.00fd.e900.0309
   Parent interface: nve1
  ES State: Up
  Port-channel state: N/A
  NVE Interface: nve1
   NVE State: Up
   Host Learning Mode: control-plane
  Active Vlans: 1
   DF Vlans: 1
   Active VNIs: \
  CC failed for VLANs:  
  VLAN CC timer: no-timer
  Number of ES members: 1
  My ordinal: 0
  DF timer start time: 00:00:00
  Config State: N/A
  DF List: 10.3.0.2  
  ES route added to L2RIB: True
  EAD/ES routes added to L2RIB: False
  EAD/EVI route timer age: not running
----------------------------------------
</code></pre></div></div><h2 id="3110-wrap-up"> <a href="#3110-wrap-up" class="anchor-heading" aria-labelledby="3110-wrap-up"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1.10 Wrap Up</h2><p>This ends the overview of DCNM Virtual Lab setup. We’ll look into DCNM APIs and Dashboards in the next update, <a href="https://j-sulliman.github.io/2021/05/04/Part-3.2-DCNM-Building-a-Multidomain-Dashboard-with-Cisco-APIs-and-Grafana.html">Building a DCNM Dashboard with Grafana, Django and Python</a>.</p><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">All content and views expressed here is my own and does not represent the views of my employer.</p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0 mr-2"> Page last modified: <span class="d-inline-block">May 5 2021 at 08:00 AM</span>.</p></div></footer></div></div></div>
